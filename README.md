# DeepLearnerâ€”â€”â€”â€”åŸºäº Pytorch çš„æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒå·¥å…·

ä¸º**é»„ç»ªè‰º**ä¸“é—¨ç¼–å†™çš„ Pytorch æ·±åº¦å­¦ä¹ æ¡†æ¶å·¥å…·æ•™ç¨‹ï¼Œæœ‰é—®é¢˜ *@ç¥å¥‡ä¹‹æ˜Ÿ*ã€ğŸ˜œã€‘

## 1. é¡¹ç›®ç»“æ„

1. **æ¨¡å‹**ï¼š./modelsã€ç©ºï¼Œå­˜æ”¾é¢„è®­ç»ƒæ¨¡å‹ä¸æ£€æŸ¥ç‚¹ã€‘
   1. **æ¨¡å‹æ£€æŸ¥ç‚¹**ï¼š./models/checkpoints/
   2. **é¢„è®­ç»ƒæ¨¡å‹**ï¼š./models/pretrained/
2. **æ•°æ®**ï¼š./dataã€ç©ºï¼Œå­˜æ”¾ä»»åŠ¡æ•°æ®é›†ã€‘
3. **æ¨¡å‹è®­ç»ƒä¸è¯„ä¼°æ¡†æ¶ï¼ˆæ ¸å¿ƒï¼‰**ï¼š./Learner
   1. **å·¥å…·åŒ…**ï¼š./Learner/utils
   2. **è‡ªå®šä¹‰æ¨¡å‹ç±»**ï¼š./Learner/models
   3. **æ•°æ®é›†æ„å»ºç±»**ï¼š./Learner/datasets
   4. **æ¨¡å‹è®­ç»ƒç±»**ï¼š./Learner/trainers

## 2. å·¥å…·åŒ…

### 2.1 è‡ªå®šä¹‰å­¦ä¹ ç‡è°ƒåº¦å™¨

- Learner.utils.lr
   1. **çº¿æ€§é¢„çƒ­+ä½™å¼¦é€€ç«è°ƒåº¦å™¨**ï¼šWarmUpCosineAnnealingLR
   2. **ç»˜åˆ¶å­¦ä¹ ç‡è°ƒåº¦å™¨å˜åŒ–æ›²çº¿**ï¼šdraw_lr

![learning rate](./imgs/lr.png)

### 2.2 æ•°æ®é›†åˆ’åˆ†

- Learner.utils.split
   1. **æŒ‰ç…§æ¯”ä¾‹åˆ’åˆ†è®­ç»ƒé›†ã€éªŒè¯é›†ï¼ˆå¯é€‰ï¼‰ã€æµ‹è¯•é›†ï¼ˆå¯é€‰ï¼‰**ï¼šsplit_three_ways

### 2.3 å¯è§†åŒ–

- Learner.utils.plot
  1. **è®­ç»ƒæŸå¤±**ï¼šdraw_loss
  2. **æ··æ·†çŸ©é˜µ**ï¼šconf_matrix
  3. **å¤šç»´æ—¶é—´åºåˆ—æ›²çº¿**ï¼šplot_ts
  4. **æ—¶é—´åºåˆ—é¢„æµ‹æ›²çº¿**ï¼šplot_forecast_comparison

![conf_matrix](./imgs/conf.png)

![time_series](./imgs/series.png)

![series_forecast](./imgs/forecast.png)

## 3. æ¨¡å‹

å­˜æ”¾ä¸€äº›è‡ªå®šä¹‰çš„æ¨¡å‹æ¶æ„

- Learner.modelsï¼š
   - Vgg
   - Conv1d+GRU

## 4. æ•°æ®é›†æ„å»ºç±»

å­˜æ”¾ä¸€äº›è‡ªå®šä¹‰çš„æ•°æ®é›†æ„å»ºç±»ï¼š
- Learner.datasetsï¼š
   - time_series_datasetsï¼šå¤šç»´æ—¶é—´åºåˆ—é¢„æµ‹æ•°æ®åŠ è½½
   - textformer_datasetsï¼šTransformer Transformer æ–‡æœ¬æ ‡ç­¾å¯¹åŠ è½½

## 5. Trainer ç±»

å®šä¹‰äº`trainer.py`ä¸­ã€‚

**åŠŸèƒ½ï¼š**

1. åˆå§‹åŒ–ï¼š__init__
   1. å®šä¹‰æ¨¡å‹è®­ç»ƒæ‰€éœ€å·¥å…·
      1. ä¼˜åŒ–å™¨
      2. å­¦ä¹ ç‡è°ƒåº¦å™¨
      3. æ¢¯åº¦ç¼©æ”¾å™¨
      4. æŸå¤±å‡½æ•°
      5. . . .
   2. å®šä¹‰æ¨¡å‹è®­ç»ƒæ‰€éœ€è¶…å‚æ•°
      1. epochs
      2. batch_size
      3. learning_rate
      4. . . .
   3. åŠ è½½æ¨¡å‹è®­ç»ƒæ‰€éœ€æ•°æ®
      1. è®­ç»ƒé›†
      2. å‘å±•é›†ï¼ˆå¯é€‰ï¼Œä¸æ”¹å˜ä½¿ç”¨æ–¹æ³•ï¼‰
   4. è‡ªåŠ¨æ£€æµ‹ GPU
2. æ¨¡å‹è®­ç»ƒæ¥å£ï¼š__fit__
   1. ç®¡ç†æ¨¡å‹æ£€æŸ¥ç‚¹ï¼ŒåŒ…å«ï¼š
      1. æ¨¡å‹å‚æ•°
      2. ä¼˜åŒ–å™¨çŠ¶æ€
      3. è®­ç»ƒçš„è½®æ•°
      4. è®­ç»ƒé›†æŸå¤±
      5. å‘å±•é›†æŸå¤±ï¼ˆæ²¡æœ‰å‘å±•é›†åˆ™æ²¡æœ‰ï¼‰
      6. å‘å±•åŠå‡†ç¡®ç‡ï¼ˆæ²¡æœ‰å‘å±•é›†åˆ™æ²¡æœ‰ï¼‰
   2. æ¨¡å‹è®­ç»ƒæ–¹æ³•
      1. **å¯åˆ†æ®µè®­ç»ƒ**ï¼Œåªéœ€æŒ‡æ˜åŠ è½½æ¨¡å‹çš„ç¼–å·å³å¯
         1. æ£€æŸ¥ç‚¹å‘½åè§„åˆ™ï¼š`checkpoint_*.pth`ï¼Œå…¶ä¸­`*`ä¸ºåŠ è½½çš„æ¨¡å‹çš„è®­ç»ƒæ€»è½®æ•°
         2. è®­ç»ƒåæŒ‰è§„åˆ™ä¿å­˜æ–°æ£€æŸ¥ç‚¹
      2. é€šè¿‡**ç»§æ‰¿ Trainer ç±»**è‡ªå®šä¹‰æ¨¡å‹è®­ç»ƒä¸éªŒè¯æ–¹æ³•
   3. è®­ç»ƒæ•°æ®å›¾åƒç»˜åˆ¶
      1. è®­ç»ƒé›†æŸå¤±æ›²çº¿
      2. å‘å±•é›†æŸå¤±æ›²çº¿ï¼ˆæ²¡æœ‰å‘å±•é›†åˆ™æ²¡æœ‰ï¼‰
      3. å‘å±•é›†å‡†ç¡®ç‡æ›²çº¿ï¼ˆæ²¡æœ‰å‘å±•é›†åˆ™æ²¡æœ‰ï¼‰
7. æ¨¡å‹è¯„ä¼°
8. æ¨¡å‹é¢„æµ‹

**ç”¨æ³•æ¼”ç¤ºï¼š**

1. æ ¹æ®ä»»åŠ¡ï¼Œå®šä¹‰**æ•°æ®é›†æ„å»ºæ–¹å¼**
2. åœ¨å¤–éƒ¨å®šä¹‰å¥½ç›¸åº”çš„å·¥å…·ï¼ˆä¼˜åŒ–å™¨ã€å­¦ä¹ ç‡è°ƒåº¦å™¨ã€æ•°æ®é›†åŠ è½½å™¨ ...ï¼‰
3. ç»§æ‰¿ Trainer ç±»å¹¶æ ¹æ®ä»»åŠ¡**é‡å†™ä»¥ä¸‹æ–¹æ³•**
   1. __forward_pass__ï¼šå‰å‘ä¼ æ’­ä¸æŸå¤±è®¡ç®—
   2. __dev__ï¼šæ¨¡å‹éªŒè¯ä¸æŒ‡æ ‡è®¡ç®—
   3. __eval__ï¼šæ¨¡å‹è¯„ä¼°æ–¹æ³•
   4. __predict__ï¼šæ¨¡å‹é¢„æµ‹æ–¹æ³•
4. **å®ä¾‹åŒ–**è‡ªå®šä¹‰çš„ Trainer å­ç±»ï¼Œä¼ å…¥ç›¸åº”çš„å‚æ•°ï¼Œè°ƒç”¨ **fit** æ–¹æ³•å³å¯è¿›è¡Œæµç•…è®­ç»ƒ

```Python
# å®šä¹‰æ¨¡å‹å‚æ•°
vocab_size = 21128  # è¯æ±‡è¡¨å¤§å°
hidden_size = 768  # éšè—å±‚å¤§å°
max_position_embeddings = 512  # åºåˆ—çš„æœ€å¤§é•¿åº¦
num_hidden_layers = 4  # Transformer å±‚çš„æ•°é‡
num_attention_heads = 8  # æ³¨æ„åŠ›å¤´çš„æ•°é‡
num_labels = len(tag_set)  # æ ‡ç­¾æ•°é‡
batch_size = 256  # æ ·æœ¬æ‰¹é‡

# åˆå§‹åŒ–æ¨¡å‹å¯¹è±¡
model = EncoderModelWithCRF(
        vocab_size, 
        max_position_embeddings,
        num_hidden_layers, 
        hidden_size, 
        num_attention_heads, 
        num_labels
)

# æ•°æ®åŠ è½½å™¨
train_loader = DataLoader(train_dataset, batch_size=batch_size, shuffle=True)
dev_loader = DataLoader(dev_dataset, batch_size=batch_size, shuffle=False)  # éªŒè¯æ—¶ä¸éœ€è¦shuffle

# ä¼˜åŒ–å™¨
optimizer = optim.AdamW(model.parameters(), lr=5e-5)
scaler = GradScaler()
# å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼šéªŒè¯é›†ä¸Šçš„æ€§èƒ½æŒ‡æ ‡åœæ­¢æå‡æ—¶ï¼Œå‡å°å­¦ä¹ ç‡æ¥å¸®åŠ©æ¨¡å‹è·³å‡ºå±€éƒ¨æœ€ä¼˜ï¼Œç»§ç»­ä¼˜åŒ–
scheduler = optim.lr_scheduler.ReduceLROnPlateau(
        optimizer,
        mode='min',
        factor=0.1,
        patience=5
)

# è®­ç»ƒå™¨
trainer = Trainer(
    model=model,  # æ¨¡å‹
    train_dataloader=train_loader,  # è®­ç»ƒé›†åŠ è½½å™¨
    dev_dataloader=dev_loader,  # éªŒè¯é›†åŠ è½½å™¨
    scaler=scaler,  # æ¢¯åº¦ç¼©æ”¾å™¨
    optimizer=optimizer,  # ä¼˜åŒ–å™¨ï¼šå¸¦åŠ¨é‡çš„éšæœºæ¢¯åº¦ä¸‹é™ 
    scheduler=scheduler,  # å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼šéªŒè¯é›†ä¸Šçš„æ€§èƒ½æŒ‡æ ‡åœæ­¢æå‡æ—¶ï¼Œå‡å°å­¦ä¹ ç‡æ¥å¸®åŠ©æ¨¡å‹è·³å‡ºå±€éƒ¨æœ€ä¼˜ï¼Œç»§ç»­ä¼˜åŒ–
    batch_size=batch_size,  # æ ·æœ¬æ‰¹é‡
    model_path='./model/checkpoint/',  # æ¨¡å‹æ£€æŸ¥ç‚¹ä¿å­˜è·¯å¾„
)

# è®­ç»ƒè½®æ¬¡ 1~20
trainer.fit(
    epoch_num=20,  # è®­ç»ƒè½®æ¬¡æ•°
    pretrain=0,  # é¢„è®­ç»ƒæ¨¡å‹ç¼–å·ï¼ˆ0 ä»£è¡¨æ²¡æœ‰ï¼‰
)
```

è®­ç»ƒæ—¥å¿—è¾“å‡ºï¼š

```text
æ— é¢„è®­ç»ƒæ¨¡å‹ï¼Œä»é›¶å¼€å§‹è®­ç»ƒ . . .
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:05<00:00,  2.52it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.51it/s]
ç¬¬ 1 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.12058644361987517ï¼Œå‘å±•é›† loss ä¸º 0.08586227569790665ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9193435468697769
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:07<00:00,  2.52it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.49it/s]
ç¬¬ 2 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.07473805309293462ï¼Œå‘å±•é›† loss ä¸º 0.0612432196397673ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9353729537841071
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:10<00:00,  2.49it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.52it/s]
ç¬¬ 3 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.056853939682342015ï¼Œå‘å±•é›† loss ä¸º 0.04973207804382094ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9435586561458625
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:09<00:00,  2.50it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:21<00:00,  1.49it/s]
ç¬¬ 4 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.046509532318390036ï¼Œå‘å±•é›† loss ä¸º 0.04167734957800424ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9509518591763468
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:08<00:00,  2.50it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.51it/s]
ç¬¬ 5 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.0393467993914952ï¼Œå‘å±•é›† loss ä¸º 0.035370468931688256ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9575185987302188
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:03<00:00,  2.54it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.50it/s]
ç¬¬ 6 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.034210996172144945ï¼Œå‘å±•é›† loss ä¸º 0.032208996086019626ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9595380661794355
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:05<00:00,  2.53it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.50it/s]
ç¬¬ 7 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.030264556107566856ï¼Œå‘å±•é›† loss ä¸º 0.02965508191653889ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9618651365599195
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:12<00:00,  2.48it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:24<00:00,  1.44it/s]
ç¬¬ 8 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.027077135375954887ï¼Œå‘å±•é›† loss ä¸º 0.02706876825079445ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9652147648391693
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:04<00:00,  2.54it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.52it/s]
ç¬¬ 9 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.024376021784798793ï¼Œå‘å±•é›† loss ä¸º 0.024224317532556116ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.968644912393289
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:14<00:00,  2.47it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.51it/s]
ç¬¬ 10 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.022091998341715054ï¼Œå‘å±•é›† loss ä¸º 0.023229461144040193ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9693565993945994
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:08<00:00,  2.51it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.50it/s]
ç¬¬ 11 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.0200248502549671ï¼Œå‘å±•é›† loss ä¸º 0.02200943138257962ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9716178626499581
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:07<00:00,  2.52it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:22<00:00,  1.46it/s]
ç¬¬ 12 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.01830952251491286ï¼Œå‘å±•é›† loss ä¸º 0.020410754706341128ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9732816487557564
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [05:57<00:00,  2.59it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.52it/s]
ç¬¬ 13 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.01684800097396299ï¼Œå‘å±•é›† loss ä¸º 0.019135370831320848ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9741806471055587
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:09<00:00,  2.50it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:21<00:00,  1.48it/s]
ç¬¬ 14 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.01547356611984536ï¼Œå‘å±•é›† loss ä¸º 0.018562518700972693ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9761097298628644
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:20<00:00,  2.43it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.50it/s]
ç¬¬ 15 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.014298564851187266ï¼Œå‘å±•é›† loss ä¸º 0.017546491662794646ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9764337458952982
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:09<00:00,  2.50it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:26<00:00,  1.40it/s]
ç¬¬ 16 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.013228093235636557ï¼Œå‘å±•é›† loss ä¸º 0.017887786892819994ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9765128241109374
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:12<00:00,  2.48it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:20<00:00,  1.50it/s]
ç¬¬ 17 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.012332732361858284ï¼Œå‘å±•é›† loss ä¸º 0.016420549915118283ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9772483622474645
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:19<00:00,  2.43it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.52it/s]
ç¬¬ 18 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.011479841177331614ï¼Œå‘å±•é›† loss ä¸º 0.015806308951352006ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9787765754393389
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:08<00:00,  2.51it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:19<00:00,  1.51it/s]
ç¬¬ 19 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.01072267169693235ï¼Œå‘å±•é›† loss ä¸º 0.015527156093119344ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9793853426840557
æ¨¡å‹è®­ç»ƒ: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 924/924 [06:13<00:00,  2.47it/s]
æ¨¡å‹éªŒè¯: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 121/121 [01:24<00:00,  1.44it/s]
ç¬¬ 20 è½®è®­ç»ƒç»“æŸï¼Œè®­ç»ƒé›† loss ä¸º 0.010025135430938754ï¼Œå‘å±•é›† loss ä¸º 0.014879551564135458ï¼Œå‘å±•é›†å‡†ç¡®ç‡ä¸º 0.9797082694681145
```

è®­ç»ƒå›¾åƒç»˜åˆ¶ï¼š

![train loss](./imgs/loss.png)
